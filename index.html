<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>êµ¬ì¡° ì ê²€ ë„êµ¬ (ê³µí†µ + ì¹´í…Œê³ ë¦¬)</title>
  <style>
    :root{
      --bg:#0b0f17; --card:#121a26; --line:#233044; --text:#eaf0ff; --muted:#a8b3c7;
      --green:#22c55e; --yellow:#f59e0b; --red:#ef4444; --blue:#60a5fa;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
      background:linear-gradient(180deg,#070a11 0%, #0b0f17 40%, #070a11 100%); color:var(--text);}
    .wrap{max-width:980px; margin:0 auto; padding:24px 16px 56px}
    h1{font-size:22px; margin:0 0 8px}
    .sub{color:var(--muted); line-height:1.5; margin:0 0 18px}
    .card{background:rgba(18,26,38,.9); border:1px solid var(--line); border-radius:14px; padding:16px; margin:12px 0}
    .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
    label{font-size:13px; color:var(--muted)}
    select, textarea, button{
      border-radius:12px; border:1px solid var(--line); background:#0d1420; color:var(--text);
      padding:10px 12px; font-size:14px;
    }
    select{min-width:260px}
    textarea{width:100%; min-height:220px; resize:vertical; line-height:1.6}
    button{cursor:pointer; background:linear-gradient(180deg,#1b2a44 0%, #132035 100%); border:1px solid #2a3b55}
    button:hover{border-color:#3a5174}
    button:disabled{opacity:.5; cursor:not-allowed}
    .hint{color:var(--muted); font-size:12px; margin-top:6px}
    details{border:1px solid var(--line); border-radius:12px; padding:12px; background:rgba(13,20,32,.6)}
    summary{cursor:pointer; font-weight:600}
    .pill{display:inline-flex; gap:6px; align-items:center; border:1px solid var(--line); padding:6px 10px; border-radius:999px; color:var(--muted); font-size:12px}
    .dot{width:10px; height:10px; border-radius:999px; display:inline-block}
    .g{background:var(--green)} .y{background:var(--yellow)} .r{background:var(--red)}
    .legend{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
    .kpi{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px}
    .kpi .pill{color:var(--text)}
    .kpi strong{font-weight:800}
    .section-title{display:flex; align-items:center; justify-content:space-between; gap:12px; margin:0 0 10px}
    .section-title h2{font-size:16px; margin:0}
    .small{font-size:12px; color:var(--muted)}
    .items{display:flex; flex-direction:column; gap:10px}
    .item{border:1px solid var(--line); border-radius:12px; padding:12px; background:rgba(13,20,32,.45)}
    .item-head{display:flex; gap:10px; align-items:flex-start; justify-content:space-between}
    .item-left{display:flex; gap:10px; align-items:flex-start}
    .badge{min-width:118px; display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700}
    .badge.g{background:rgba(34,197,94,.15); color:var(--green); border:1px solid rgba(34,197,94,.35)}
    .badge.y{background:rgba(245,158,11,.15); color:var(--yellow); border:1px solid rgba(245,158,11,.35)}
    .badge.r{background:rgba(239,68,68,.15); color:var(--red); border:1px solid rgba(239,68,68,.35)}
    .item-title{font-weight:800; margin:0 0 6px}
    .item-msg{margin:0; color:var(--muted); line-height:1.55}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace; color:#cbd5e1}
    .footer{margin-top:14px; color:var(--muted); font-size:12px; line-height:1.6}
    .warn{border-left:3px solid var(--yellow); padding-left:10px; margin:8px 0; color:var(--muted)}
    .err{border-left:3px solid var(--red); padding-left:10px; margin:8px 0; color:var(--muted)}
    .ok{border-left:3px solid var(--green); padding-left:10px; margin:8px 0; color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>êµ¬ì¡° ì ê²€ ë„êµ¬ (ê³µí†µ + ì¹´í…Œê³ ë¦¬)</h1>
    <p class="sub">
      ì´ ë„êµ¬ëŠ” ê¸€ì˜ â€œì •ë‹µ/ì˜¤ë‹µâ€ì„ íŒì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì˜ <b>íŒë‹¨ìê°€ ì–´ë””ì—ì„œ ë©ˆì¶”ê±°ë‚˜ ì˜¤í•´í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ì§€</b>ë¥¼
      <b>êµ¬ì¡° ì‹ í˜¸</b>ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. ìµœì¢… íŒë‹¨ê³¼ ìˆ˜ì •ì€ ì‘ì„±ìê°€ í•©ë‹ˆë‹¤.
    </p>

    <div class="card">
      <details>
        <summary>ì‚¬ìš© ë°©ë²• (ì ‘ê¸°/ë”ë³´ê¸°)</summary>
        <div class="warn">
          â€¢ 1íšŒ ì ê²€ ë‹¨ìœ„ëŠ” <b>ìµœëŒ€ 1,200ì</b>ì…ë‹ˆë‹¤. ê¸´ ë¬¸ì„œëŠ” í•µì‹¬ ë‹¨ë½/ì„¹ì…˜ ë‹¨ìœ„ë¡œ ë‚˜ëˆ  ì ê²€í•˜ì„¸ìš”.<br/>
          â€¢ ê²°ê³¼ëŠ” â€œí‰ê°€â€ê°€ ì•„ë‹ˆë¼ <b>íŒë‹¨ ë¦¬ìŠ¤í¬ ì‹ í˜¸</b>ì…ë‹ˆë‹¤. (ğŸŸ¢ ë‚®ìŒ / ğŸŸ¡ í•´ì„ í¸ì°¨ ê°€ëŠ¥ / ğŸ”´ íŒë‹¨ ì§€ì—°Â·ì˜¤í•´ ê°€ëŠ¥)
        </div>
        <ol style="margin:10px 0 0 18px; color:var(--muted); line-height:1.6;">
          <li>ìƒë‹¨ì—ì„œ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.</li>
          <li>ì¤‘ê°„ ì…ë ¥ì°½ì— ì ê²€í•  ê¸€(ìµœëŒ€ 1,200ì)ì„ ë¶™ì—¬ë„£ìŠµë‹ˆë‹¤.</li>
          <li><b>ì ê²€í•˜ê¸°</b>ë¥¼ ëˆ„ë¥´ë©´ í•˜ë‹¨ì— ê³µí†µ ì²´í¬ + ì¹´í…Œê³ ë¦¬ ì²´í¬ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</li>
          <li>ğŸ”´/ğŸŸ¡ í•­ëª©ì€ â€œìˆ˜ì • ì§€ì‹œâ€ê°€ ì•„ë‹ˆë¼, <b>íŒë‹¨ì´ ì§€ì—°ë  ìˆ˜ ìˆëŠ” êµ¬ì¡°</b>ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
        </ol>
      </details>
    </div>

    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <div>
          <label for="category">ì¹´í…Œê³ ë¦¬ ì„ íƒ</label><br/>
          <select id="category">
            <option value="internal_notice">ë‚´ë¶€ ì•ˆë‚´(ê³µì§€)</option>
            <option value="work_report">ì—…ë¬´ ë³´ê³ (ìƒì‚¬/ê²°ì¬)</option>
            <option value="c_level">C-level ë©”ì‹œì§€</option>
            <option value="press_release">ë³´ë„ìë£Œ(Press Release)</option>
            <option value="sns">SNS ê¸€</option>
          </select>
          <div class="hint">ì¹´í…Œê³ ë¦¬ëŠ” â€œëˆ„ê°€ ì½ëŠ”ì§€(íŒë‹¨ì ê´€ì )â€ë¥¼ ê³ ì •í•˜ê¸° ìœ„í•œ ì„ íƒì…ë‹ˆë‹¤.</div>
        </div>
        <div class="legend">
          <span class="pill"><span class="dot g"></span>ğŸŸ¢ íŒë‹¨ ë¦¬ìŠ¤í¬ ë‚®ìŒ</span>
          <span class="pill"><span class="dot y"></span>ğŸŸ¡ í•´ì„ í¸ì°¨ ê°€ëŠ¥</span>
          <span class="pill"><span class="dot r"></span>ğŸ”´ íŒë‹¨ ì§€ì—°Â·ì˜¤í•´ ê°€ëŠ¥</span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">
        <h2>ê¸€ ì…ë ¥</h2>
        <span class="small">ê¸€ì ìˆ˜: <span id="charCount" class="mono">0</span> / 1200</span>
      </div>
      <textarea id="text" placeholder="ì—¬ê¸°ì— ì ê²€í•  ê¸€ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. (ìµœëŒ€ 1,200ì)"></textarea>
      <div class="row" style="margin-top:10px; justify-content:space-between;">
        <span class="hint">íŒ: ë©”ì¼/ê³µì§€/ë³´ê³ ëŠ” â€œê²°ë¡ (ìš”ì§€) â†’ ê·¼ê±° â†’ ë‹¤ìŒ ì•¡ì…˜â€ ìˆœì„œê°€ ê°€ì¥ ë¹¨ë¦¬ ì½í™ë‹ˆë‹¤.</span>
        <button id="analyzeBtn">ì ê²€í•˜ê¸°</button>
      </div>
      <div id="limitMsg" class="err" style="display:none;"></div>
    </div>

    <div id="results" class="card" style="display:none;">
      <div class="section-title">
        <h2>ì ê²€ ê²°ê³¼</h2>
        <span class="small" id="resultMeta"></span>
      </div>

      <div id="overall" class="ok" style="display:none;"></div>
      <div id="overallWarn" class="warn" style="display:none;"></div>
      <div id="overallErr" class="err" style="display:none;"></div>

      <div class="kpi" id="kpi"></div>

      <div style="margin-top:14px;">
        <div class="section-title">
          <h2>ê³µí†µ ì²´í¬</h2>
          <span class="small">ëª¨ë“  ê¸€ì— ì ìš©ë˜ëŠ” êµ¬ì¡° ì‹ í˜¸</span>
        </div>
        <div class="items" id="commonItems"></div>
      </div>

      <div style="margin-top:14px;">
        <div class="section-title">
          <h2>ì¹´í…Œê³ ë¦¬ ì²´í¬</h2>
          <span class="small" id="catTitle"></span>
        </div>
        <div class="items" id="categoryItems"></div>
      </div>

      <div class="footer">
        â€» ê²°ê³¼ëŠ” â€œì •ë‹µ íŒì •â€ì´ ì•„ë‹ˆë¼, ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì˜ íŒë‹¨ìê°€ <b>ë¹ ë¥´ê²Œ ì´í•´/íŒë‹¨í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆëŠ” êµ¬ì¡°</b>ë¥¼ ì•Œë ¤ì£¼ëŠ” ì‹ í˜¸ì…ë‹ˆë‹¤.<br/>
        â€» ê¸´ ë¬¸ì„œ(2,000ì ì´ìƒ)ëŠ” ì„¹ì…˜ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ì ê²€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
      </div>
    </div>
  </div>

<script>
/** -----------------------------
 *  Utilities
 * ----------------------------- */
const MAX_CHARS = 1200;

function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

function countChars(s){
  // JS length counts UTF-16 code units; for Korean this is practically ok for UX
  return (s || "").trim().length;
}

function normalize(s){
  return (s || "")
    .replace(/\r\n/g, "\n")
    .replace(/[ \t]+/g, " ")
    .replace(/\n{3,}/g, "\n\n")
    .trim();
}

function splitParagraphs(s){
  const t = normalize(s);
  if(!t) return [];
  return t.split(/\n{2,}/).map(x => x.trim()).filter(Boolean);
}

function splitLines(s){
  const t = normalize(s);
  if(!t) return [];
  return t.split(/\n/).map(x => x.trim()).filter(Boolean);
}

function splitSentences(s){
  // Rough sentence splitter for Korean/English mixed text
  const t = normalize(s);
  if(!t) return [];
  // Prefer punctuation boundaries; keep short lines
  const raw = t
    .replace(/([.!?])\s+/g, "$1\n")
    .replace(/(ë‹¤\.|ë‹ˆë‹¤\.|ìš”\.)\s+/g, "$1\n")
    .split("\n")
    .map(x => x.trim())
    .filter(Boolean);
  return raw;
}

function ratioIndexOfAny(text, tokens){
  const t = normalize(text);
  if(!t) return -1;
  const idx = tokens
    .map(tok => t.indexOf(tok))
    .filter(i => i >= 0)
    .sort((a,b)=>a-b)[0];
  if(idx === undefined) return -1;
  return idx / t.length;
}

function countMatches(text, patterns){
  const t = normalize(text);
  if(!t) return 0;
  let c = 0;
  for(const p of patterns){
    const re = (p instanceof RegExp) ? p : new RegExp(p, "g");
    const m = t.match(re);
    if(m) c += m.length;
  }
  return c;
}

function hasAny(text, tokens){
  const t = normalize(text);
  return tokens.some(tok => t.includes(tok));
}

function extractDates(text){
  const t = normalize(text);
  const re = /(\d{1,2}ì›”\s?\d{1,2}ì¼|\d{4}[./-]\d{1,2}[./-]\d{1,2}|\d{1,2}[./-]\d{1,2}[./-]\d{2,4})/g;
  return t.match(re) || [];
}

function extractContacts(text){
  const t = normalize(text);
  const emails = t.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/ig) || [];
  const phones = t.match(/(01[016789]-?\d{3,4}-?\d{4}|\d{2,3}-\d{3,4}-\d{4})/g) || [];
  return {emails, phones};
}

function findFirstLineWith(text, tokens){
  const lines = splitLines(text);
  for(let i=0;i<lines.length;i++){
    if(tokens.some(tok => lines[i].includes(tok))) return {i, line: lines[i]};
  }
  return null;
}

function makeStatus(level){
  // level: "g" | "y" | "r"
  if(level==="g") return {badge:"ğŸŸ¢ íŒë‹¨ ë¦¬ìŠ¤í¬ ë‚®ìŒ", cls:"g"};
  if(level==="y") return {badge:"ğŸŸ¡ í•´ì„ í¸ì°¨ ê°€ëŠ¥", cls:"y"};
  return {badge:"ğŸ”´ íŒë‹¨ ì§€ì—°Â·ì˜¤í•´ ê°€ëŠ¥", cls:"r"};
}

function renderItem(container, title, level, message){
  const st = makeStatus(level);
  const div = document.createElement("div");
  div.className = "item";
  div.innerHTML = `
    <div class="item-head">
      <div class="item-left">
        <span class="badge ${st.cls}"><span class="dot ${st.cls}"></span>${st.badge}</span>
        <div>
          <div class="item-title">${title}</div>
          <p class="item-msg">${message}</p>
        </div>
      </div>
    </div>
  `;
  container.appendChild(div);
}

/** -----------------------------
 *  Core Checks (Common)
 * ----------------------------- */
const PURPOSE_CUES = ["ì•ˆë‚´", "ê³µì§€", "ê³µìœ ", "ìš”ì²­", "ë³´ê³ ", "ê²°ì •", "í™•ì¸ ë¶€íƒ", "í˜‘ì¡°", "ê°ì‚¬", "ì°¸ê³ "];
const CONCLUSION_CUES = ["ìš”ì²­ë“œë¦½ë‹ˆë‹¤", "ë¶€íƒë“œë¦½ë‹ˆë‹¤", "í™•ì¸ ë¶€íƒ", "ê²°ì •", "ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤", "ì§„í–‰ ì˜ˆì •", "ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤", "ê³µìœ ë“œë¦½ë‹ˆë‹¤", "ì°¸ê³  ë¶€íƒ", "íšŒì‹  ë¶€íƒ", "ì‹ ì²­ ë¶€íƒ", "ì œì¶œ ë¶€íƒ"];
const CONNECTORS = ["ê·¸ë¦¬ê³ ", "ë˜í•œ", "ë‹¤ë§Œ", "í•˜ì§€ë§Œ", "ì´ì—", "ì´ì— ë”°ë¼", "ë”°ë¼ì„œ", "ê·¸ëŸ¬ë‚˜", "í•œí¸", "ì•„ìš¸ëŸ¬", "ì¦‰", "ì¦‰,", "ê·¸ëŸ¬ë¯€ë¡œ", "ë˜ëŠ”", "ë°˜ë©´"];
const ABSTRACT_WORDS = ["ì „ë°˜", "ë‹¤ì–‘", "íš¨ê³¼", "ì˜ë¯¸", "ìµœì ", "ê°•í™”", "ê°œì„ ", "í™•ëŒ€", "ì¶”ì§„", "ì „ê°œ", "ì²´ê³„", "ì „ëµ", "ë°©í–¥"];
const EXAGGERATIONS = ["ìµœê³ ", "ìµœì´ˆ", "ìœ ì¼", "ì••ë„", "í˜ì‹ ", "ì„ ë„", "ì™„ë²½", "í•„ìˆ˜", "ë°˜ë“œì‹œ", "íšê¸°ì "];

function commonChecks(text){
  const t = normalize(text);
  const chars = t.length;
  const paragraphs = splitParagraphs(t);
  const sentences = splitSentences(t);
  const lines = splitLines(t);

  const results = [];

  // 1) ê¸€ì ìˆ˜
  if(chars === 0){
    results.push({title:"ì…ë ¥ ì—¬ë¶€", level:"r", msg:"í…ìŠ¤íŠ¸ê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ì ê²€í•  ê¸€ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."});
    return results;
  }
  if(chars > MAX_CHARS){
    results.push({title:"ê¸€ì ìˆ˜ ì œí•œ", level:"r", msg:`í˜„ì¬ ${chars}ìì…ë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” 1íšŒ ì ê²€ ë‹¨ìœ„ë¥¼ ìµœëŒ€ 1,200ìë¡œ ê°€ì •í•©ë‹ˆë‹¤. í•µì‹¬ ë‹¨ë½/ì„¹ì…˜ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì ê²€í•´ ì£¼ì„¸ìš”.`});
  } else {
    results.push({title:"ê¸€ì ìˆ˜ ì œí•œ", level:"g", msg:`${chars}ì. 1íšŒ ì ê²€ ë‹¨ìœ„(â‰¤ 1,200ì)ë¡œ ì ì ˆí•©ë‹ˆë‹¤.`});
  }

  // 2) ë¬¸ë‹¨ ë¶„ë¦¬
  if(paragraphs.length <= 1){
    results.push({title:"ë¬¸ë‹¨ ë¶„ë¦¬", level:"y", msg:"ë¬¸ë‹¨ êµ¬ë¶„ì´ ì•½í•©ë‹ˆë‹¤. ì¤„ë°”ê¿ˆ(ë¹ˆ ì¤„)ì„ ë„£ì–´ ë‹¨ë½ì„ 2~5ê°œë¡œ ë‚˜ëˆ„ë©´ íŒë‹¨ ë™ì„ ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤."});
  } else if(paragraphs.length >= 7){
    results.push({title:"ë¬¸ë‹¨ ë¶„ë¦¬", level:"y", msg:`ë¬¸ë‹¨ì´ ${paragraphs.length}ê°œë¡œ ë§ìŠµë‹ˆë‹¤. ìš”ì§€/ê·¼ê±°/ì•¡ì…˜ ì¤‘ì‹¬ìœ¼ë¡œ ë¬¶ì–´ ë‹¨ë½ ìˆ˜ë¥¼ ì¤„ì´ë©´ ì½ëŠ” í”¼ë¡œê°€ ê°ì†Œí•©ë‹ˆë‹¤.`});
  } else {
    results.push({title:"ë¬¸ë‹¨ ë¶„ë¦¬", level:"g", msg:`ë¬¸ë‹¨ ${paragraphs.length}ê°œ. ì½ê¸° ë™ì„ ì´ ë¹„êµì  ì•ˆì •ì ì…ë‹ˆë‹¤.`});
  }

  // 3) ì²« 20% ìš”ì§€ ë‹¨ì„œ
  const purposePos = ratioIndexOfAny(t, PURPOSE_CUES);
  if(purposePos < 0){
    results.push({title:"ìš”ì§€ ë‹¨ì„œ(ì´ˆë°˜)", level:"y", msg:"ì²« êµ¬ê°„ì— ê¸€ì˜ ì„±ê²©(ì•ˆë‚´/ìš”ì²­/ê³µìœ /ë³´ê³  ë“±)ì´ ë“œëŸ¬ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì²« ë¬¸ë‹¨ì— ëª©ì  í•œ ì¤„ì„ ì¶”ê°€í•˜ë©´ íŒë‹¨ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤."});
  } else if(purposePos <= 0.20){
    results.push({title:"ìš”ì§€ ë‹¨ì„œ(ì´ˆë°˜)", level:"g", msg:"ì´ˆë°˜ì— ê¸€ì˜ ì„±ê²© ë‹¨ì„œê°€ ë“±ì¥í•©ë‹ˆë‹¤. ë…ìê°€ â€˜ë¬´ìŠ¨ ê¸€ì¸ì§€â€™ ë¹ ë¥´ê²Œ ì¡ì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤."});
  } else {
    results.push({title:"ìš”ì§€ ë‹¨ì„œ(ì´ˆë°˜)", level:"y", msg:"ìš”ì§€ ë‹¨ì„œê°€ ë¹„êµì  ë’¤ì— ë“±ì¥í•©ë‹ˆë‹¤. ì²« ë¬¸ë‹¨ì—ì„œ ê¸€ì˜ ì„±ê²©(ì•ˆë‚´/ìš”ì²­/ê³µìœ /ë³´ê³ )ì„ ë¨¼ì € ì œì‹œí•˜ë©´ ì¬ë… ê°€ëŠ¥ì„±ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."});
  }

  // 4) ê²°ë¡ /ìš”ì²­ ìœ„ì¹˜
  const conclPos = ratioIndexOfAny(t, CONCLUSION_CUES);
  if(conclPos < 0){
    results.push({title:"ê²°ë¡ /ìš”ì²­ ìœ„ì¹˜", level:"y", msg:"ê²°ë¡ /ìš”ì²­ì„ ì•”ì‹œí•˜ëŠ” ë¬¸ì¥ì´ ëšœë ·í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì˜ˆ: â€˜í™•ì¸ ë¶€íƒ/ìš”ì²­ë“œë¦½ë‹ˆë‹¤/ì§„í–‰ ì˜ˆì •â€™ ë“±) ë…ìê°€ í–‰ë™ì„ ì¶”ì •í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."});
  } else if(conclPos <= 0.55){
    results.push({title:"ê²°ë¡ /ìš”ì²­ ìœ„ì¹˜", level:"g", msg:"ê²°ë¡ /ìš”ì²­ì´ ë¬¸ì„œ ì¤‘ë°˜ ì´ì „ì— ë“±ì¥í•©ë‹ˆë‹¤. íŒë‹¨ ë™ì„ ì´ ì•ˆì •ì ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤."});
  } else {
    results.push({title:"ê²°ë¡ /ìš”ì²­ ìœ„ì¹˜", level:"y", msg:"ê²°ë¡ /ìš”ì²­ì´ í›„ë°˜ì— ëª°ë ¤ ìˆìŠµë‹ˆë‹¤. í•µì‹¬ ê²°ë¡ (ë˜ëŠ” ìš”ì²­)ì„ ìƒë‹¨(ì²« 3~5ì¤„)ìœ¼ë¡œ ëŒì–´ì˜¬ë¦¬ë©´ íŒë‹¨ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤."});
  }

  // 5) í•µì‹¬ ë¬¸ì¥ í›„ë³´(1ë¬¸ì¥ ìš”ì•½ ê°€ëŠ¥ì„±)
  const keyLine = findFirstLineWith(t, ["ìš”ì•½", "í•µì‹¬", "ê²°ë¡ ", "ì •ë¦¬", "ìš”ì²­", "ì•ˆë‚´", "ê³µìœ ", "ë³´ê³ "]);
  if(keyLine){
    results.push({title:"í•µì‹¬ ë¬¸ì¥(ìš”ì•½ ê°€ëŠ¥ì„±)", level:"g", msg:`í•µì‹¬ì„ ì¡ì„ ìˆ˜ ìˆëŠ” ë¬¸ì¥ì´ ê°ì§€ë©ë‹ˆë‹¤. (ì˜ˆ: â€œ${keyLine.line.slice(0,60)}${keyLine.line.length>60?"â€¦":""}â€)`});
  } else {
    results.push({title:"í•µì‹¬ ë¬¸ì¥(ìš”ì•½ ê°€ëŠ¥ì„±)", level:"y", msg:"í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì§€ë¥¼ ì¡ì„ â€˜ì•µì»¤ ë¬¸ì¥â€™ì´ ì•½í•©ë‹ˆë‹¤. ì²« ë¬¸ë‹¨ì— ëª©ì /ê²°ë¡ ì„ 1ë¬¸ì¥ìœ¼ë¡œ ì¶”ê°€í•˜ë©´ ì „ì²´ê°€ ì •ë¦¬ë©ë‹ˆë‹¤."});
  }

  // 6) ê¸´ ë¬¸ì¥ ì—°ì† ì‹ í˜¸
  const longSentences = sentences.filter(s => s.length >= 80);
  if(longSentences.length >= 3){
    results.push({title:"ê¸´ ë¬¸ì¥(ê°€ë…ì„±)", level:"y", msg:`ê¸´ ë¬¸ì¥ì´ ${longSentences.length}ê°œ ê°ì§€ë©ë‹ˆë‹¤. í•œ ë¬¸ì¥ì— ë©”ì‹œì§€ê°€ 2ê°œ ì´ìƒ ì¤‘ì²©ë  ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ë¬¸ì¥ì„ ë¶„í• í•˜ë©´ ì´í•´ ì†ë„ê°€ ê°œì„ ë©ë‹ˆë‹¤.`});
  } else if(longSentences.length >= 1){
    results.push({title:"ê¸´ ë¬¸ì¥(ê°€ë…ì„±)", level:"y", msg:"ê¸´ ë¬¸ì¥ì´ ì¼ë¶€ ê°ì§€ë©ë‹ˆë‹¤. í•µì‹¬ ë¬¸ì¥ì€ ì§§ê²Œ, ê·¼ê±°ëŠ” ë¬¸ë‹¨ìœ¼ë¡œ ë¶„ë¦¬í•˜ë©´ ì½ê¸° ë¶€ë‹´ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."});
  } else {
    results.push({title:"ê¸´ ë¬¸ì¥(ê°€ë…ì„±)", level:"g", msg:"ë¬¸ì¥ ê¸¸ì´ê°€ ê³¼ë„í•˜ê²Œ ê¸¸ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°€ë…ì„± ë¦¬ìŠ¤í¬ê°€ ë‚®ìŠµë‹ˆë‹¤."});
  }

  // 7) ì ‘ì†ì‚¬ ê³¼ë‹¤(ì „ê°œ í”¼ë¡œ)
  const connCount = countMatches(t, CONNECTORS.map(w => new RegExp(w, "g")));
  const connPer1000 = (connCount / Math.max(chars,1)) * 1000;
  if(connPer1000 >= 18){
    results.push({title:"ì ‘ì†ì‚¬ ë°€ë„(ì „ê°œ í”¼ë¡œ)", level:"y", msg:"ì ‘ì†ì‚¬ê°€ ì¦ìŠµë‹ˆë‹¤. ë¬¸ì¥ ì—°ê²°ì„ ì ‘ì†ì‚¬ë¡œ í•´ê²°í•˜ê¸°ë³´ë‹¤ ë¬¸ë‹¨ êµ¬ì¡°(ìš”ì§€â†’ê·¼ê±°â†’ì•¡ì…˜)ë¡œ ì •ë¦¬í•˜ë©´ ì „ê°œê°€ ê¹”ë”í•´ì§‘ë‹ˆë‹¤."});
  } else if(connPer1000 >= 10){
    results.push({title:"ì ‘ì†ì‚¬ ë°€ë„(ì „ê°œ í”¼ë¡œ)", level:"y", msg:"ì ‘ì†ì‚¬ ì‚¬ìš©ì´ ë‹¤ì†Œ ë§ìŠµë‹ˆë‹¤. ê°™ì€ ì—­í• ì˜ ì ‘ì†ì‚¬ëŠ” ì¼ë¶€ ìƒëµí•´ë„ ì˜ë¯¸ê°€ ìœ ì§€ë©ë‹ˆë‹¤."});
  } else {
    results.push({title:"ì ‘ì†ì‚¬ ë°€ë„(ì „ê°œ í”¼ë¡œ)", level:"g", msg:"ì ‘ì†ì‚¬ ë°€ë„ê°€ ê³¼ë„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."});
  }

  // 8) ì¶”ìƒì–´ ë°€ë„
  const absCount = countMatches(t, ABSTRACT_WORDS.map(w => new RegExp(w, "g")));
  const absPer1000 = (absCount / Math.max(chars,1)) * 1000;
  if(absPer1000 >= 14){
    results.push({title:"ì¶”ìƒì–´ ë°€ë„(í•´ì„ í¸ì°¨)", level:"y", msg:"ì¶”ìƒì–´ ë¹„ì¤‘ì´ ë†’ìŠµë‹ˆë‹¤. (ì „ë°˜/ê°•í™”/ê°œì„ /ì „ëµ ë“±) í•µì‹¬ ë¬¸ì¥ì—ëŠ” â€˜ëˆ„ê°€/ë¬´ì—‡ì„/ì–¸ì œâ€™ ê°™ì€ êµ¬ì²´ ìš”ì†Œë¥¼ ë¶™ì´ë©´ í•´ì„ í¸ì°¨ê°€ ì¤„ì–´ë“­ë‹ˆë‹¤."});
  } else {
    results.push({title:"ì¶”ìƒì–´ ë°€ë„(í•´ì„ í¸ì°¨)", level:"g", msg:"ì¶”ìƒì–´ ë°€ë„ê°€ ê³¼ë„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."});
  }

  // 9) ì „ì œ-ê²°ë¡  ì í”„ ì‹ í˜¸(ê²½í–¥)
  // heuristic: conclusion cue exists but because/ê·¼ê±° ë‹¨ì„œ ë¶€ì¡±
  const hasConcl = conclPos >= 0;
  const hasReasonCue = hasAny(t, ["ì™œëƒí•˜ë©´", "ë•Œë¬¸ì—", "ê·¼ê±°", "í˜„í™©", "ë°°ê²½", "ìƒí™©", "ì´ì— ë”°ë¼", "ë¡œ ì¸í•´", "ë”°ë¼"]);
  if(hasConcl && !hasReasonCue && chars >= 400){
    results.push({title:"ì „ì œ-ê²°ë¡  ì—°ê²°(ì í”„ ì‹ í˜¸)", level:"y", msg:"ê²°ë¡ /ìš”ì²­ì€ ìˆìœ¼ë‚˜, ê·¸ ê·¼ê±°/ë°°ê²½ ë‹¨ì„œê°€ ì•½í•©ë‹ˆë‹¤. ë…ìê°€ â€˜ì™œ ì§€ê¸ˆ ì´ ê²°ë¡ ì¸ê°€â€™ë¥¼ ì¶”ì •í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."});
  } else {
    results.push({title:"ì „ì œ-ê²°ë¡  ì—°ê²°(ì í”„ ì‹ í˜¸)", level:"g", msg:"ê²°ë¡ /ìš”ì²­ê³¼ ë°°ê²½ ë‹¨ì„œì˜ ì—°ê²° ì‹ í˜¸ê°€ í¬ê²Œ ë¶ˆì•ˆì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."});
  }

  // 10) í–‰ë™ ê°€ëŠ¥ì„±(ëˆ„ê°€/ë¬´ì—‡ì„/ì–¸ì œ/ì–´ë””ì„œ ì¤‘ 2ê°œ ì´ìƒ)
  const who = hasAny(t, ["ëŒ€ìƒ", "ì „ ì§ì›", "ì „ì‚¬", "ëª¨ë“ ", "í•´ë‹¹", "ë‹´ë‹¹", "ê° ë¶€ì„œ", "íŒ€", "ë¶€ì„œ"]);
  const what = hasAny(t, ["ì‹ ì²­", "ì œì¶œ", "í™•ì¸", "ì°¸ì—¬", "ê³µìœ ", "íšŒì‹ ", "ê²€í† ", "ì§„í–‰", "ì—…ë¡œë“œ", "ì‘ì„±"]);
  const when = extractDates(t).length > 0 || hasAny(t, ["ì˜¤ëŠ˜", "ë‚´ì¼", "ê¸ˆì£¼", "ì´ë²ˆ ì£¼", "ì´ë²ˆë‹¬", "ê¹Œì§€", "ë§ˆê°"]);
  const where = hasAny(t, ["ë§í¬", "ì²¨ë¶€", "ê·¸ë£¹ì›¨ì–´", "í¬í„¸", "ë©”ì¼", "í˜ì´ì§€", "í¼", "ì–‘ì‹"]);
  const cnt = [who,what,when,where].filter(Boolean).length;

  if(cnt >= 2){
    results.push({title:"í–‰ë™ ê°€ëŠ¥ì„±(ëª…í™•ì„±)", level:"g", msg:"í–‰ë™ì— í•„ìš”í•œ ë‹¨ì„œ(ëˆ„ê°€/ë¬´ì—‡ì„/ì–¸ì œ/ì–´ë””ì„œ)ê°€ ìµœì†Œ 2ê°œ ì´ìƒ ë“œëŸ¬ë‚©ë‹ˆë‹¤."});
  } else {
    results.push({title:"í–‰ë™ ê°€ëŠ¥ì„±(ëª…í™•ì„±)", level:"y", msg:"í–‰ë™ ë‹¨ì„œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ëŒ€ìƒ(ëˆ„ê°€) + í–‰ë™(ë¬´ì—‡) ë˜ëŠ” ê¸°í•œ(ì–¸ì œ) ì¤‘ ìµœì†Œ 2ê°€ì§€ë¥¼ ëª…ì‹œí•˜ë©´ ì§ˆë¬¸ ë°œìƒ ê°€ëŠ¥ì„±ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."});
  }

  return results;
}

/** -----------------------------
 *  Category Checks
 * ----------------------------- */
const CATEGORY_META = {
  internal_notice: {name:"ë‚´ë¶€ ì•ˆë‚´(ê³µì§€)", judge:"êµ¬ì„±ì›/ì‹¤ë¬´ì"},
  work_report: {name:"ì—…ë¬´ ë³´ê³ (ìƒì‚¬/ê²°ì¬)", judge:"ì˜ì‚¬ê²°ì •ì/ê²°ì¬ê¶Œì"},
  c_level: {name:"C-level ë©”ì‹œì§€", judge:"ì¡°ì§ êµ¬ì„±ì›/ì™¸ë¶€ ì´í•´ê´€ê³„ì"},
  press_release: {name:"ë³´ë„ìë£Œ(Press Release)", judge:"ê¸°ì/ì™¸ë¶€ ë…ì"},
  sns: {name:"SNS ê¸€", judge:"ëŒ€ì¤‘/íŒ”ë¡œì›Œ"}
};

function categoryChecks(text, category){
  const t = normalize(text);
  const chars = t.length;
  const lines = splitLines(t);
  const sentences = splitSentences(t);
  const results = [];

  if(category === "internal_notice"){
    // 1) ìš©ê±´ 1ì¤„
    const hasPurpose = hasAny(t, ["ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤", "ê³µì§€ë“œë¦½ë‹ˆë‹¤", "ê³µìœ ë“œë¦½ë‹ˆë‹¤", "ë‹¤ìŒ ì‚¬í•­", "ì•„ë˜ì™€ ê°™ì´"]);
    results.push({
      title:"ìš©ê±´(ì²« í™”ë©´) ëª…ì‹œ",
      level: hasPurpose ? "g" : "y",
      msg: hasPurpose
        ? "ìš©ê±´ì„ ì•Œë¦¬ëŠ” í‘œí˜„ì´ ê°ì§€ë©ë‹ˆë‹¤. êµ¬ì„±ì›ì´ â€˜ë¬´ìŠ¨ ì•ˆë‚´ì¸ì§€â€™ ì¡ê¸° ì‰¬ìš¸ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤."
        : "ì²« ë¬¸ë‹¨ì—ì„œ ìš©ê±´ì´ ëšœë ·í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. â€˜ë¬´ì—‡ì„ ì•ˆë‚´í•˜ëŠ”ì§€â€™ë¥¼ 1ë¬¸ì¥ìœ¼ë¡œ ë¨¼ì € ì œì‹œí•˜ë©´ ë¬¸ì˜ê°€ ì¤„ì–´ë“­ë‹ˆë‹¤."
    });

    // 2) ëŒ€ìƒ/ë²”ìœ„
    const hasTarget = hasAny(t, ["ì „ ì§ì›", "ì „ì‚¬", "í•´ë‹¹ ë¶€ì„œ", "ëŒ€ìƒ", "ê° íŒ€", "ì „ êµ¬ì„±ì›"]);
    results.push({
      title:"ëŒ€ìƒ/ë²”ìœ„",
      level: hasTarget ? "g" : "y",
      msg: hasTarget ? "ëŒ€ìƒ/ë²”ìœ„ ë‹¨ì„œê°€ ë³´ì…ë‹ˆë‹¤." : "ëˆ„ê°€ ì ìš© ëŒ€ìƒì¸ì§€ê°€ íë¦¿í•©ë‹ˆë‹¤. â€˜ëŒ€ìƒ/ë²”ìœ„â€™ë¥¼ 1ì¤„ë¡œ ë¶„ë¦¬í•´ ì£¼ì„¸ìš”."
    });

    // 3) í–‰ë™/ì ˆì°¨(ë¬´ì—‡ì„ ì–´ë–»ê²Œ)
    const hasSteps = hasAny(t, ["ì‹ ì²­", "ì‘ì„±", "ì œì¶œ", "í™•ì¸", "ë‹¤ìš´ë¡œë“œ", "ì°¸ì—¬"]) && (hasAny(t, ["ë°©ë²•", "ê²½ë¡œ", "ì ˆì°¨", "â†’", "1.", "2.", "â€¢"]));
    results.push({
      title:"í–‰ë™/ì ˆì°¨(ë¬´ì—‡ì„ ì–´ë–»ê²Œ)",
      level: hasSteps ? "g" : "y",
      msg: hasSteps ? "ì ˆì°¨/ê²½ë¡œ ì‹ í˜¸(ë²ˆí˜¸/ë¶ˆë¦¿/ê²½ë¡œ)ê°€ ë³´ì…ë‹ˆë‹¤." : "í–‰ë™/ì ˆì°¨ê°€ ë¬¸ì¥ ì†ì— ë¬»í ìˆ˜ ìˆìŠµë‹ˆë‹¤. â€˜ê²½ë¡œ/ë°©ë²•â€™ì„ ë²ˆí˜¸ë‚˜ ë¶ˆë¦¿ìœ¼ë¡œ ë¶„ë¦¬í•˜ë©´ ì‹¤í–‰ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤."
    });

    // 4) ê¸°í•œ/ì‹œì 
    const dates = extractDates(t);
    const hasDeadline = dates.length > 0 || hasAny(t, ["ê¹Œì§€", "ë§ˆê°", "ê¸°í•œ", "ê¸°ê°„"]);
    results.push({
      title:"ê¸°í•œ/ì‹œì ",
      level: hasDeadline ? "g" : "y",
      msg: hasDeadline ? "ê¸°í•œ/ì‹œì  ë‹¨ì„œê°€ ë³´ì…ë‹ˆë‹¤." : "ê¸°í•œ/ì‹œì  ë‹¨ì„œê°€ ì•½í•©ë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° â€˜ì–¸ì œê¹Œì§€/ì–¸ì œë¶€í„°â€™ë¥¼ ëª…ì‹œí•˜ë©´ í˜¼ì„ ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."
    });

    // 5) ì˜ˆì™¸/ì£¼ì˜ ë¶„ë¦¬
    const hasException = hasAny(t, ["ë‹¨,", "ë‹¤ë§Œ", "ìœ ì˜", "ì£¼ì˜", "â€»", "ì°¸ê³ :", "ì˜ˆì™¸"]);
    results.push({
      title:"ì˜ˆì™¸/ì£¼ì˜(í•„ìš” ì‹œ) ë¶„ë¦¬",
      level: hasException ? "g" : "y",
      msg: hasException ? "ì£¼ì˜/ì˜ˆì™¸ ì‹ í˜¸ê°€ ë¶„ë¦¬ë˜ì–´ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤." : "ì£¼ì˜/ì˜ˆì™¸ê°€ í•„ìš”í•œ ê¸€ì´ë¼ë©´, â€˜ë‹¨/ìœ ì˜ì‚¬í•­â€™ì„ ë³„ë„ ë¼ì¸ìœ¼ë¡œ ë¶„ë¦¬í•´ ì£¼ì„¸ìš”."
    });

    // 6) ë¬¸ì˜ì²˜
    const c = extractContacts(t);
    const hasContact = hasAny(t, ["ë¬¸ì˜", "ë‹´ë‹¹"]) || c.emails.length>0 || c.phones.length>0;
    results.push({
      title:"ë¬¸ì˜ ê²½ë¡œ",
      level: hasContact ? "g" : "y",
      msg: hasContact ? "ë¬¸ì˜/ë‹´ë‹¹ ë‹¨ì„œê°€ ìˆìŠµë‹ˆë‹¤." : "ë¬¸ì˜ ê²½ë¡œê°€ ì—†ìœ¼ë©´ ì¶”ê°€ ì§ˆë¬¸ì´ ëŠ˜ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš” ì‹œ â€˜ë¬¸ì˜: ë‹´ë‹¹/ë©”ì¼â€™ 1ì¤„ì„ ì¶”ê°€í•˜ì„¸ìš”."
    });
  }

  if(category === "work_report"){
    // 1) ë³´ê³  ìœ í˜• íƒœê·¸
    const head = (lines[0] || "");
    const hasTag = /^\s*\[(ê³µìœ |ìš”ì²­|ê²°ì •|ë³´ê³ )\]/.test(head) || hasAny(head, ["ê³µìœ ", "ìš”ì²­", "ê²°ì •", "ë³´ê³ "]);
    results.push({
      title:"ë³´ê³  ìœ í˜•(ê³µìœ /ìš”ì²­/ê²°ì •) ëª…ì‹œ",
      level: hasTag ? "g" : "y",
      msg: hasTag ? "ë³´ê³  ì„±ê²© ë‹¨ì„œê°€ ì´ˆë°˜ì— ë³´ì…ë‹ˆë‹¤." : "ì´ˆë°˜ì— ë³´ê³  ì„±ê²©ì´ ë¶ˆëª…í™•í•©ë‹ˆë‹¤. ì œëª©/ì²«ì¤„ì— [ê³µìœ ]/[ìš”ì²­]/[ê²°ì •] í˜•íƒœë¡œ ê³ ì •í•˜ë©´ íŒë‹¨ì´ ë¹¨ë¼ì§‘ë‹ˆë‹¤."
    });

    // 2) ê²°ë¡  ì„ ë°°ì¹˜(ì²« 3~5ì¤„)
    const firstBlock = lines.slice(0,5).join(" ");
    const hasAskOrConcl = hasAny(firstBlock, ["ìš”ì²­", "í™•ì¸ ë¶€íƒ", "ê²°ì •", "ê³µìœ ", "ë“œë¦¬ë©°", "ë³´ê³ ë“œë¦½ë‹ˆë‹¤", "ê²°ì¬", "ê²€í†  ë¶€íƒ"]);
    results.push({
      title:"ê²°ë¡ /ìš”ì²­ ì„ ë°°ì¹˜(ì´ˆë°˜)",
      level: hasAskOrConcl ? "g" : "y",
      msg: hasAskOrConcl ? "ì´ˆë°˜ì— ê²°ë¡ /ìš”ì²­ ë‹¨ì„œê°€ ìˆìŠµë‹ˆë‹¤." : "ê²°ë¡ /ìš”ì²­ì´ ì´ˆë°˜ì— ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. â€˜ê²°ë¡  1ì¤„ â†’ ê·¼ê±°â€™ ìˆœìœ¼ë¡œ ì¬ë°°ì¹˜í•˜ë©´ ê²°ì¬ ì‹œê°„ì´ ì¤„ì–´ë“­ë‹ˆë‹¤."
    });

    // 3) ê·¼ê±°/í˜„í™©(ìµœì†Œ 1ê°œ)
    const hasEvidence = /(\d+(\.\d+)?%|\d{1,3}(,\d{3})+|\d+ëª…|\d+ê±´|\d+íšŒ|\d+ì›)/.test(t) || hasAny(t, ["í˜„í™©", "ê·¼ê±°", "ë°ì´í„°", "ìˆ˜ì¹˜", "ë°°ê²½"]);
    results.push({
      title:"ê·¼ê±°/í˜„í™©(ìµœì†Œ ë‹¨ì„œ)",
      level: hasEvidence ? "g" : "y",
      msg: hasEvidence ? "ê·¼ê±°/í˜„í™© ë‹¨ì„œê°€ ìˆìŠµë‹ˆë‹¤." : "ê²°ë¡ ì„ ë’·ë°›ì¹¨í•˜ëŠ” ê·¼ê±° ë‹¨ì„œê°€ ì•½í•©ë‹ˆë‹¤. ìˆ˜ì¹˜
